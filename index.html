<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta property="og:image" content="http://SmallHabitsBigChange.com/water-assets/logo.png">
    <meta property="og:site_name" content="SmallHabitsBigChange" />
    <meta property="og:title" content="SmallHabitsBigChange" />
    <meta property="og:url" content="http://SmallHabitsBigChange.com/">
    <meta name="description" content="SmallHabitsBigChange is an initiative to start saving water.">
    <meta name="keywords" content="PUB, water, saving, conservation, future, saving water, NYP, nanyang polytechnic">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="flip.css" />
    <link rel="stylesheet" href="water-assets/fullpage.min.css" />
    <link rel="stylesheet" href="water-assets/loaders.min.css" />
    <link rel="icon" type="image/png" href="water-assets/logo.png" />

    <style>
        @media (max-width: 1024px) {
            #pledges-list>div:nth-child(n + 4) {
                display: none;
            }

            @media (max-width: 768px) {
                #pledges-list>div:nth-child(n + 5) {
                    display: none;
                }
            }
        }
    </style>
    <title>#SmallHabitsBigChange</title>
</head>


<body>
    <div id="fullpage">
        <div class="section">
            <div id="introduction" class="row no-gutters justify-content-center h-100">
                <div class="table-display">
                    <div class="table-child">
                        <div class="row justify-content-lg-end">
                            <div id="intro-gif" class="col-md-4">
                                <img src="water-assets/water-intro.gif" alt="" class="img-fluid">
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="pledges-border">
                                    <div id=" counter-container"
                                        class="d-flex justify-content-lg-start justify-content-md-center">
                                        <h1 id="counter"></h1>
                                        <p class="counter-subtitle" style="line-height: 61px;">pledges</p>
                                    </div>
                                    <div class="mt-1">
                                        <p class="tagline font-weight-bold"
                                            style="font-size: 1.5rem; margin-bottom:0%;">
                                            #StayFirm
                                        </p>
                                        <p class="tagline font-weight-bold" style="font-size: 1rem;">
                                            Small Habits, Big Change
                                        </p>
                                        <p class="counter-subtitle mt-2">I will pledge too!</p>

                                        <div class="text-">
                                            <button class="btn btn-dark rounded-0" type="button"
                                                onclick="incrementPledges()">
                                                Make my choice
                                            </button>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <img id="intro-image" src="water-assets/firm/firm-thumbsup.png" class="img-fluid" />
            </div>
        </div>

        <div class="section">
            <div class="container p-3">
                <div class="row justify-content-center">
                    <h1 id="pledge-title">Recent Pledges</h1>
                </div>
                <div id="landing-loading" class="loader text-center">
                    <div class="ball-pulse">
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                </div>
                <div id="pledges-list" class="row no-gutters justify-content-center">
                </div>
                <div class="text-center text-dark my-4"><a href="/pledges">Click here to view all
                        pledges</a></div>
            </div>
        </div>


        <div class="section">
            <div class="row no-gutters justify-content-lg-center justify-content-md-center bg-blue h-100">
                <div class="col-lg-6 col-md-10 fs-18">
                    <div id="who-is-firm-content" class="text-center text-dark px-4">
                        <div>
                            <h1 class="mb-3" style="font-size: 50px;">Who is Firm?</h1>
                            <p>
                                This is Firm. He is an ignorant 18 year old who unknowingly portrays bad
                                water wasting habits. He does not turn off the tap while brushing his
                                teeth or
                                while shampooing his hair.
                            </p>
                            <p>
                                Furthermore, Firm does not believe that making small changes in his
                                daily life to conserve water will lead to any significant impact for
                                water-conservation in Singapore.
                            </p>

                            <p>
                                Join Firm on this journey to make changes in his habits by following our
                                Instagram page
                                <a href="https://www.instagram.com/smallhabits.bigchange/"
                                    target="_blank"><u>here!</u></a>
                            </p>
                        </div>
                        <img id="who-is-firm" src="water-assets/firm/firm-wave.png" class="img-fluid" />
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="row no-gutters justify-content-center">
                <div class="col-md-5">
                    <h1 class="text-center" id="did-you-know">Did you know?</h1>

                    <div class="carousel-container">
                        <div id="carouselExampleControls" class="carousel slide carousel" data-ride="carousel">
                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <img class="d-block w-100" src="water-assets/carousel/soaping-hand.jpeg"
                                        alt="Soaping Hand">
                                    <p class="text-center mt-4 fs-18"><span class="font-weight-bold">Fact
                                            #1:<br /></span>
                                        Soaping
                                        your hands with the tap on, is one the most common water-wasting habits which
                                        leads
                                        to nearly 300 ml of water wasted
                                    </p>
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block w-100" src="water-assets/carousel/shower.jpeg" alt="Shower">
                                    <p class="text-center mt-4 fs-18"><span class="font-weight-bold">Fact
                                            #2:<br /></span>
                                        By cutting down 5 minutes of your shower time, <br />
                                        you can save 45 litres of water a day
                                    </p>
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block w-100" src="water-assets/carousel/washing-machine.jpeg"
                                        alt="Washing Machine">
                                    <p class="text-center mt-4 fs-18"><span class="font-weight-bold">Fact
                                            #3:<br /></span>
                                        That water from your washing machine, can be used for <br />
                                        flushing, scrubbing or washing the toilet
                                    </p>
                                </div>
                            </div>
                            <a class="carousel-control-prev" href="#carouselExampleControls" role="button"
                                data-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="sr-only">Previous</span>
                            </a>
                            <a class="carousel-control-next " href="#carouselExampleControls" role="button"
                                data-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="sr-only">Next</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- <div class="row no-gutters justify-content-center">
                 -->
        </div>

        <div class="section">
            <div class="row no-gutters justify-content-center">
                <div class="col-md-12">
                    <h1 class="text-center px-3">Keep Up to Date With Us!</h1>
                    <div class="row mt-5 justify-content-center">
                        <div class="col-md-8">
                            <script src="https://apps.elfsight.com/p/platform.js" defer></script>
                            <div class="elfsight-app-e864b9cb-0b68-400c-9862-6358603d885e"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="row no-gutters justify-content-center">
                <div id="who-we-are-firm" class="col-lg-3 col-md-8 ">
                    <img src="water-assets/firm/firm-gotchu-2.png" class="img-fluid"
                        style="max-height: 700px; margin-top: 50px;" />
                </div>
                <div class="col-lg-4 col-md-8 col-sm-10 p-3">
                    <div class="table-display">
                        <div class="table-child">
                            <div class="who-we-are-container">
                                <h1 class="text-center">Who Are We?</h1>
                                <div class="row mt-5">
                                    <h4>About Us</h4>
                                    <p>
                                        Hey everyone! We are a group of students from Nanyang Polytechnic.
                                        We started this social movement campaign "Small Habits, Big Change" because the
                                        majority of youths in Singapore are unaware
                                        that the smallest of actions leads to water wastage.
                                    </p>
                                </div>
                                <div class="row mt-4">
                                    <h4>Campaign Objectives</h4>
                                    <p>
                                        The objectives of our campaign are to change youth's attitudes and beliefs
                                        towards
                                        saving water by getting them to be more
                                        responsible by continuing to take steps to save water even after the completion
                                        of
                                        the campaign.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-12 text-center mt-2">
                <p style="font-size: 12px">
                    Copyright &COPY; SmallHabitsBigChange. Contact Us<a class="footer-link text-white"
                        href="mailto:shbigchange2020@gmail.com">
                        <u>Here</u>.
                    </a>
                    <br />Dallas & Randy.
                </p>
            </div>
        </div>
    </div>
    </div>
</body>

<!-- Dependencies for Javascript Events -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>

<!-- Dependencies for Javascript Events -->
<script src="water-assets/scroll-overflow.min.js"></script>
<script src="water-assets/fullpage.js"></script>
<script src="https://cdn.jsdelivr.net/npm/countup@1.8.2/countUp.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
<script src="water-assets/badwords.js"></script>

<script>
    new fullpage('#fullpage', {
        autoScrolling: true,
        scrollHorizontally: true,
        navigation: true,
        navigationPosition: "right",
        scrollOverflow: true,
        loopBottom: true,
        fitToSection: false,
        sectionsColor: ['#f0f0e6', 'rgb(255, 250, 251)', '#bdedec', '#FFFFFF', '#51a7a8', '#FFFFFF'],
    });

    const checkBox = (int, text) => {
        return `<div class="checkbox-div"><div class='custom-control custom-checkbox'><input value='${text}' type='checkbox' class='custom-control-input' id='cb_${int}'><label class='custom-control-label' for='cb_${int}'>${text}</label></div><div>`
    }

    const set1Questions = [
        "Taking shorter showers of about 5 minutes. [save 9litres of water per minute]",
        "Switch off the shower tap while shampooing or soaping your body. [save 9 litres of water per minute]",
        "Use a dish of water to clean your shaver [save 6 litres of water per minute]",
        "Use a mug while brushing your teeth. [save 50ml]",
        "Use the half flush when there is only liquid waste. [save 3 litres]",
        "Install thimbles or water- saving devices at taps with high flow rate. [get PUB's water saving kit!]"
    ]

    const set2Questions = [
        "Use a filled sink or bucket of water to rinse your dirty dishes. [save 6 litres of water per minute]",
        "Use the washing machine only with a full load. [save 53 litres to 94.6 litres per use]",
        "Wash vegetables with a filled sink instead of a running tap. [save 6 litres of water per minute]",
        "Don't thaw frozen food under running water. [save 6 litres of water per minute]",
        "Water plants by using a watering can instead of a running hose. [save 22 litres of water per minute]",
        "Reuse water used for washing dishes or washing rice to flush the toilet.",
    ]

    const createSet1CheckBoxes = () => {
        let output = "<div class='px-3'>";
        for (let i = 0; i < set1Questions.length; i++) {
            output += checkBox(i, set1Questions[i]);
        }
        output += "</div>"
        return output;
    }

    const createSet2CheckBoxes = () => {
        let output = "<div class='px-3'>";
        for (let i = 0; i < set2Questions.length; i++) {
            output += checkBox(i + 6, set2Questions[i]);
        }
        output += "</div>"
        return output;
    }

    appendLeadingZeroes = (n) => {
        if (n <= 9) {
            return "0" + n;
        }
        return n
    }

    incrementPledges = () => {
        Swal.mixin({
            input: 'text',
            confirmButtonText: 'Next &rarr;',
            showCancelButton: true,
            allowOutsideClick: false,
            progressSteps: ['1', '2', '3', '4']
        }).queue([
            {
                title: 'Before we start,<br/>can we get your name?',
                input: "",
                html: `<div class="m-2"><input id="pledgerName" type="text" class="form-control rounded-0"
                                            placeholder="Your name or blank for 'Anonymous'"
                                            aria-label="Recipient's username" aria-describedby="button-addon2" required></div>`,
                preConfirm: () => {
                    let pledgerName = Swal.getPopup().querySelector('#pledgerName').value;
                    return { pledgerName: pledgerName }
                }
            },
            {
                title: 'For my toilet and shower habits, I pledge to...',
                text: 'choose as many as you like',
                input: "",
                allowOutsideClick: false,
                html: createSet1CheckBoxes(),
                preConfirm: () => {
                    let cb_0 = Swal.getPopup().querySelector('#cb_0').checked;
                    let cb_1 = Swal.getPopup().querySelector('#cb_1').checked;
                    let cb_2 = Swal.getPopup().querySelector('#cb_2').checked;
                    let cb_3 = Swal.getPopup().querySelector('#cb_3').checked;
                    let cb_4 = Swal.getPopup().querySelector('#cb_4').checked;
                    let cb_5 = Swal.getPopup().querySelector('#cb_5').checked;
                    return { cb_0: cb_0, cb_1: cb_1, cb_2: cb_2, cb_3: cb_3, cb_4: cb_4, cb_5: cb_5 }
                }
            },
            {
                title: 'For my habits at home and in the kitchen, I pledge to...',
                text: 'choose as many as you like',
                input: "",
                allowOutsideClick: false,
                html: createSet2CheckBoxes(),
                preConfirm: () => {
                    let cb_6 = Swal.getPopup().querySelector('#cb_6').checked;
                    let cb_7 = Swal.getPopup().querySelector('#cb_7').checked;
                    let cb_8 = Swal.getPopup().querySelector('#cb_8').checked;
                    let cb_9 = Swal.getPopup().querySelector('#cb_9').checked;
                    let cb_10 = Swal.getPopup().querySelector('#cb_10').checked;
                    let cb_11 = Swal.getPopup().querySelector('#cb_11').checked;
                    return { cb_6: cb_6, cb_7: cb_7, cb_8: cb_8, cb_9: cb_9, cb_10: cb_10, cb_11: cb_11 }
                }
            }
        ]).then((result) => {
            newEntry = result;
            if (result.value) {
                Swal.fire({
                    icon: 'success',
                    title: 'Thank you for pledging!',
                    text: 'The smallest of steps counts towards making a huge impact'
                });
            }
        }).then(() => {
            postToJsonBin();
        })

    }

    // if (bad_words.includes(document.getElementById("pledgerName").value)) {
    //     Swal.fire({
    //         icon: 'error',
    //         title: 'Invalid Input',
    //         text: 'Please refrain from profanities!',
    //         allowOutsideClick: false,
    //     })
    // }
    // else {
    //     countUp.update(pledgesCounter += 1);
    //     Swal.fire({
    //         icon: 'success',
    //         title: 'Pledged',
    //         text: 'Thanks for participating!',
    //         allowOutsideClick: false,
    //     }).then(() => Swal.close());
    // }

    insertColumns = () => {
        const questions = [
            "Taking shorter showers of about 5 minutes. [save 9litres of water per minute]",
            "Switch off the shower tap while shampooing or soaping your body. [save 9 litres of water per minute]",
            "Use a dish of water to clean your shaver. [save 6 litres of water per minute]",
            "Use a mug while brushing your teeth. [save 50ml]",
            "Use the half flush when there is only liquid waste. [save 3 litres]",
            "Install thimbles or water- saving devices at taps with high flow rate. [get PUB's water saving kit!]",
            "Use a filled sink or bucket of water to rinse your dirty dishes. [save 6 litres of water per minute]",
            "Use the washing machine only with a full load. [save 53 litres to 94.6 litres per use]",
            "Wash vegetables with a filled sink instead of a running tap. [save 6 litres of water per minute]",
            "Don't thaw frozen food under running water. [save 6 litres of water per minute]",
            "Water plants by using a watering can instead of a running hose. [save 22 litres of water per minute]",
            "Reuse water used for washing dishes or washing rice to flush the toilet.",
        ]

        createIcon = (boolean, iconIndex) => {
            if (!boolean) {
                return "";
            }
            iconMeaning = questions[iconIndex - 1]
            return `<span data-toggle="tooltip" data-placement="bottom" title="${iconMeaning}"><img src="water-assets/icons/question-${iconIndex}.png" class="card-icon" /></span>`;

        }

        createColumn = (name, date, commitments) => {
            return (`
            <div class="flip-card m-2">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class='media-body p-3 mb-0 border border-gray text-truncate pledge-card shadow-sm'> <strong
                            class='text-capitalize'>
                            <h5>${name}</h5>
                        </strong><span class='feed-datetime d-block text-muted small my-1'>${date}</span>
                            <span class='d-block mb-0'>Pledged to save water!</span></div>
                    </div>
                    <div class="flip-card-back border border-gray shadow-sm">
                        <div>
                            ${createIcon(commitments[0], 1)}
                            ${createIcon(commitments[1], 2)}
                            ${createIcon(commitments[2], 3)}
                            ${createIcon(commitments[3], 4)}
                            ${createIcon(commitments[4], 5)}
                            ${createIcon(commitments[5], 6)}
                            ${createIcon(commitments[6], 7)}
                            ${createIcon(commitments[7], 8)}
                            ${createIcon(commitments[8], 9)}
                            ${createIcon(commitments[9], 10)}
                            ${createIcon(commitments[10], 11)}
                            ${createIcon(commitments[11], 12)}
                            ${createIcon(commitments[12], 13)}
                        </div>
                    </div>
                </div>
        </div >`)
        };

        let pledgeList = document.getElementById("pledges-list");

        // insertColumns = () => {
        //     pledges.map(pledge => (pledgeList.innerHTML += createColumn(pledge.pledgerName, pledge.date, pledge.commitments)));
        // }

        let top12Pledges = pledges.slice(-12).reverse();
        // let top12Pledges = pledges;
        pledgeList.innerHTML = "";
        top12Pledges.map(pledge => (pledgeList.innerHTML += createColumn(pledge.pledgerName, pledge.date, pledge.commitments)));
    }

    // For Posting
    postToJsonBin = () => {
        console.log(newEntry)
        let current_datetime = new Date()
        let formatted_date = current_datetime.getFullYear() + "-" + appendLeadingZeroes(current_datetime.getMonth() + 1) + "-" + appendLeadingZeroes(current_datetime.getDate()) + " " + appendLeadingZeroes(current_datetime.getHours()) + ":" + appendLeadingZeroes(current_datetime.getMinutes()) + ":" + appendLeadingZeroes(current_datetime.getSeconds())
        let pledgerName = newEntry["value"][0].pledgerName;
        let commitments = [newEntry["value"][1].cb_0, newEntry["value"][1].cb_1, newEntry["value"][1].cb_2, newEntry["value"][1].cb_3, newEntry["value"][1].cb_4, newEntry["value"][1].cb_5, newEntry["value"][2].cb_6, newEntry["value"][2].cb_7, newEntry["value"][2].cb_8, newEntry["value"][2].cb_9, newEntry["value"][2].cb_10, newEntry["value"][2].cb_11, newEntry["value"][2].cb_12];

        // commitments.map(newEntry["value"][2].)

        let req = new XMLHttpRequest();

        if (newEntry["value"][0].pledgerName === "") {
            pledgerName = "Anonymous"
        }

        if (bad_words.includes(pledgerName.toLowerCase())) {
            pledgerName = "Anonymous"
        }

        req.onreadystatechange = () => {
            if (req.readyState == XMLHttpRequest.DONE) {
                // Pass
            }
        };

        req.open("PUT", "https://api.jsonbin.io/b/5e2a232d50a7fe418c52a0e9", false);
        req.setRequestHeader("Content-type", "application/json");
        pledges.push({ "pledgerName": pledgerName, "date": formatted_date, "commitments": commitments });
        // console.log(pledges)
        req.send(JSON.stringify(pledges));
        insertColumns();
    }

    let pledges = [];
    let pledgesCounter = 0;
    let newEntry;
    const countUp = new CountUp(counter, 0, 0, 0, 0.6);
    const bad_words = badWords.words;

    fetch("https://api.jsonbin.io/b/5e2a232d50a7fe418c52a0e9/latest")
        .then(res => res.json())
        .then(data => pledges = data)
        .then(() => console.log(pledges))
        .then(() => insertColumns())
        .then(() => $('#landing-loading').hide())
        .then(() => pledgesCounter = pledges.length)
        .then(() => startCount())
        .catch((err) => console.log(err));


    startCount = () => {
        const counter = document.querySelector('#counter');
        const countUp = new CountUp(counter, 0, pledgesCounter, 0, 0.6);
        if (!countUp.error) {
            countUp.start()
        } else {
            console.error(countUp.error)
        }
    }


</script>

</html>